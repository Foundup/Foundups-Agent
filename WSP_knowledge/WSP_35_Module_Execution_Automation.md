# WSP 35: Module Execution Automation

**Version**: 0.1.0
**Date**: 2025-06-17
**Status**: DRAFT

## 1. Overview

This protocol defines the process by which the **Windsurf Recursive Engine (WRE)** autonomously executes software modules. It is the application of the WRE's cognitive architecture to the project's codebase, using the WSP framework as its guide. The goal is to translate strategic objectives from the `ROADMAP.md` into tangible, automated actions.

## 2. The Execution Lifecycle

The WRE follows a defined lifecycle to select, prepare, execute, and evaluate a module.

### Step 1: Goal Ingestion & Prioritization
-   **Trigger**: The WRE ingests a high-level goal from the `ROADMAP.md` or a direct user directive.
-   **Mechanism**: The `RoadmapManager` component, governed by **WSP 46**, parses the goal.
-   **Action**: The WRE consults the **WSP 5: Module Prioritization Scoring (MPS) System** to determine which module is best suited and has the highest priority to fulfill the current objective.

### Step 2: Execution Planning
-   **Mechanism**: A proposed `PlannerAgent` (**WSP 54**) is dispatched.
-   **Action**: The agent generates a detailed `Execution Plan`. This includes:
    1.  **Dependency Analysis**: Read the target module's `requirements.txt` (**WSP 12**) and verify that all dependencies are installed. If not, add the necessary `pip install` commands to the plan.
    2.  **Path Identification**: Determine the exact command or function call needed to run the module based on its `INTERFACE.md`.
    3.  **Rollback Procedure**: Define the steps required to revert any potential changes if the execution fails.
-   **Output**: A structured `Execution Plan` object.

### Step 3: Contractual Understanding
-   **Mechanism**: The `LoremasterAgent` (**WSP 54**) is dispatched.
-   **Action**: The agent reads the target module's `README.md` and `INTERFACE.md` files. This is the "contractual understanding" phase, where the WRE learns the module's purpose, its intended inputs, and its expected outputs as defined by its documentation.

### Step 4: Execution
-   **Mechanism**: The `ExecutionAgent` (**WSP 54**) is dispatched.
-   **Action**: The agent invokes the module's primary entry point as defined in its `INTERFACE.md` by following the `Execution Plan`.
-   **Error Handling**: If the execution fails or produces an unexpected result, the **WSP 45: Behavioral Coherence Protocol** is immediately triggered. The agent enters the Adaptive Resolution Loop to diagnose and correct the failure.

### Step 5: State Assessment & Chronicle
-   **Mechanism**: The `ScoringAgent` and `ChroniclerAgent` (**WSP 54**) are dispatched.
-   **Action**:
    1.  The `ScoringAgent` assesses the impact of the execution, potentially updating the module's LLME score.
    2.  The `ChroniclerAgent` records the entire lifecycle (Goal -> Understanding -> Execution -> Result -> Dissonance Analysis) in the **WSP 51: WRE Chronicle** (`ModLog.md`), providing a complete audit trail.

### 4. Agent Definitions

#### 4.1. PlannerAgent
The `PlannerAgent` is responsible for creating a safe and complete `Execution Plan`.

**Responsibilities:**
1.  **Dependency Analysis**: Adhering to **WSP 12**, it reads the target module's `requirements.txt` file. It cross-references this with the current environment to determine if any dependencies need to be installed.
2.  **Plan Generation**: It constructs a step-by-step plan that includes dependency installation (if needed), module execution, and state verification.
3.  **Rollback Definition**: It defines a clear set of instructions for the `ExecutionAgent` to follow in case of a failure, ensuring the system can be returned to its pre-execution state.

**Tooling**:
*   Access to the `wre_api_gateway` for package management (`pip`) and filesystem analysis.

#### 4.2. ExecutionAgent

The `ExecutionAgent` is the primary actor in this protocol. It is responsible for carrying out the `Execution Plan`.

**Responsibilities:**

1.  **State Verification:** Before execution, verify the system is in a "clean state" as defined by **WSP 2: Clean State Management**. This includes ensuring no uncommitted changes, a full test pass, and 100% audit compliance. If the state is not clean, the execution is aborted, and a high-priority `ComplianceViolation` is logged.
2.  **Plan Adherence:** Strictly follow the `Execution Plan` generated by the `PlannerAgent`, executing each step in the specified order.
3.  **Real-time Monitoring:** Continuously monitor the output, logs, and system state during execution.
4.  **Error Handling & Rollback:** If any step fails or produces an unexpected output, halt execution immediately. Initiate the `Rollback Procedure` defined in the `Execution Plan` to revert any changes made.
5.  **Result Logging:** Upon successful completion of a step, log the output and any state changes.
6.  **Final Report:** After the entire plan is executed (or aborted), generate a detailed `ExecutionReport`, documenting the outcome of each step, any errors encountered, and the final state of the system. The language in this report **must** adhere to the **External Professional Scope** as defined in **WSP 36: Scoped Language Protocol**.

**Tooling:**

*   Access to the `wre_api_gateway` for state verification (`git`), test execution (`pytest`), and module invocation (`python`).

## 3. Required Module Interface (`INTERFACE.md`)

For a module to be compatible with this automated execution protocol, it MUST have an `INTERFACE.md` file that specifies:
-   **`entry_point_type`**: (`script`, `function`, `class`)
-   **`entry_point_path`**: (e.g., `src/main.py`, `src/utils.py:run_analysis`)
-   **`expected_inputs`**: (Description of arguments or data format)
-   **`expected_outputs`**: (Description of expected results, artifacts, or state changes)

---

This protocol transforms the WRE from a simple orchestrator into an active, autonomous participant in the development lifecycle, directly applying the project's documented standards to its own operation. 